{"config":{"id":"","title":"Intranet Home","version":{"name":"Dunant 5","nameSuffix":"Hotfix 1","product":"Design","platform":"SharePoint","date":"Wed, 25 Apr 2018 22:15:39 GMT"},"width":null,"height":null,"bgColor":"rgb(242,242,242)","bgImage":"","bgImageStyle":"2","isBgFixed":true,"layoutType":"TableLayout","designerType":"TableDesigner","pageType":"Page","layoutConfig":{"children":[{"layoutType":"RowLayout","children":[{"layoutType":"ColumnLayout","largeWidth":12,"mediumWidth":12,"smallWidth":12,"extraSmallWidth":12,"children":[{"layoutType":"TableLayout","children":[{"tileType":"AdvancedCodeSnippetTile","name":"1.My Recent Files","width":"280","height":"400","bgColor":"rgb(255,255,255)","iconPath":"https://ltcdntest.blob.core.windows.net/design/sharepoint/v4/content/Icons/Tile Gallery/Code.svg","locked":false,"html":"<link rel=\"stylesheet\" href=\"https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/4.1.0/css/fabric.min.css\">\n<div class=\"recentFilesContainer\">\n    <div class=\"recentFilesHeader\">{{customConfig.title}}</div>\n    <a href=\"#\" id=\"oauth-token-login-button\" class=\"lt-btn\"><div class=\"authorise\">Log In</div></a>\n    <div class=\"recentFilesContent\"></div>\n</div>","css":"@textColor: @color;\n@subtitleColor: lighten(@textColor, 25%);\n\n.authorise {\n    width: 80%;\n    height: 50px;\n    background-color:rgb(255, 51, 153);\n    line-height: 50px;\n    border-radius: 5px;\n    text-align: center;\n    text-decoration: none;\n    color: white;\n    margin: 10px auto;\n    font-size: 18px;\n    max-width: 300px;\n    font-weight:300;\n}\n\n#oauth-token-login-button:hover, #oauth-token-login-button:focus {\n    text-decoration: none;\n}\n\n.recentFilesHeader {\n    text-align: center;\n    padding-top: 20px;\n    background-color: @titleBgColor;\n    height: 60px;\n    line-height: 20px;\n    color: @titleColor;\n    font-size: 16px;\n}\n.recentFilesContainer{\n    height: inherit;\n}\n.recentFilesContent{\n    height: inherit;\n    overflow-y: auto;\na {\n    text-decoration: none;\n}\n} \n\n.itemContainer {\n    padding: 10px;\n    color: @textColor;\n    clear: both;\n    overflow: auto;\n    width: 100%;\n    position: relative;\n    display: flex;\n}\n\n.itemContainer:hover {\n    background-color: rgba(1,0,0,0.1);\n}\n\n.iconContainer {\n    float: left;\n}\n\n.contentContainer {\n    float: left;\n}\n\n.altText {\n    color: lighten(@subtitleColor, 25%);\n    font-weight: 300;\n}\n\n.ms-Icon {\n    font-size: 32px;\n    padding-right: 10px;\n}\n\n.itemName {\n    font-size: 16px;\n        overflow: hidden;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n}\n\n.itemTime {\n    float:left;\n    padding-right: 10px;\n    font-size: 13px;\n    color: @subtitleColor;\n    font-weight: 300;\n}\n.itemBy {\n    float:left;\n    font-size: 13px;\n    color: @subtitleColor;\n    font-weight: 300;\n}\n\n.locationIcon {\n    position:absolute;\n    right: 10px;\n    bottom: 10px; \n}\n\n.locationIcon .ms-Icon {\n    font-size: 20px;\n    color: rgba(1,0,0,0.1);\n}\n\n//Icon Colors\n.ms-Icon--ExcelLogo {\n    color: rgb(0,158,73);\n}\n\n.ms-Icon--OneNoteLogo {\n    color: rgb(104,33,122);\n}\n\n.ms-Icon--PowerPointLogo {\n    color: rgb(255,140,0);\n}\n\n.ms-Icon--WordLogo {\n    color: rgb(0,24,143);\n}\n\n.ms-Icon--FolderFill {\n    color: rgb(255,228,194);\n}\n\n.ms-Icon--PageSolid {\n    color: #ccc;\n}\n\n","js":"var options = {\n    serviceName: 'Office365'\n};\nvar interval = null;\n\nfunction setLogin() {\n\n    LiveTilesApi.Authentication.userLoggedIn(options).then(function (check) {\n        if (check.loggedIn) {\n            LiveTilesApi.Authentication.getAuthenticationInfo(options).then(getToken).catch(function (err) {\n                $('#oauth-token-login-button').on('click', function () {\n                    LiveTilesApi.Authentication.login(options).then(function () {\n                        LiveTilesApi.Authentication.getAuthenticationInfo(options).then(getToken);\n                    });\n                });\n            });\n        } else {\n            $('#oauth-token-login-button').on('click', function () {\n                LiveTilesApi.Authentication.login(options).then(function () {\n                    LiveTilesApi.Authentication.getAuthenticationInfo(options).then(getToken);\n                });\n            });\n        }\n    });\n\n}\n\nfunction getToken(authInfo) {\n    onTokenRequestComplete(authInfo.accessToken);\n    clearInterval(interval);\n}\n\nfunction onTokenRequestComplete(token) {\n    $(\"#oauth-token-login-button\").css(\"display\", \"none\");\n\n    /* Your code here */\n    //console.log(token);\n    $.ajax({\n        url: \"https://graph.microsoft.com/v1.0/me/drive/recent\",\n        headers: {\n            'Authorization': 'Bearer ' + token,\n            'Accept': 'application/json'\n        },\n        success: function (data, status) {\n            /*console.log(data.value[3]);\n            console.log(\"Name: \" + data.value[0].name);\n            console.log(\"Web URL: \" + data.value[0].webUrl);\n            console.log(\"Created By: \" + data.value[0].createdBy.user.displayName);\n            console.log(\"Created Date Time: \" + data.value[0].createdDateTime);\n            console.log(\"LastModifiedBy: \" + data.value[0].createdBy.user.displayName);\n            console.log(\"Created Date Time: \" + data.value[0].createdDateTime);\n            console.log(data.value[0].thumbnails);*/\n\n            //console.log(data.value.length);\n            getItems(data.value);\n\n            /*$.ajax({\n                url: \"https://graph.microsoft.com/v1.0/me/drive/items/\" + data.value[0].id,\n                headers: {\n                    'Authorization': 'Bearer ' + token,\n                    'Accept': 'application/json'\n                },\n                success: function(data, status) {\n                    //console.log(data);\n                    console.log(\"Parent Folder:\" + data.webUrl);\n                }\n            });*/\n\n            /*$.ajax({\n                url: \"https://graph.microsoft.com/beta/sharePoint/sites/\" + data.value[1].remoteItem.sharepointIds.siteId,\n                headers: {\n                    'Authorization': 'Bearer ' + token,\n                    'Accept': 'application/json'\n                },\n                success: function(data, status) {\n                    console.log(data);\n                }\n            });*/\n        }\n    });\n\n    function getItems(items) {\n        var limit = Math.min(customConfig.limit, items.length);\n        for (var i = 0; i < limit; i++) {\n            var item = items[i];\n            var num = i + 1;\n\n            var iconAndName = getIconAndName(item.name);\n            var timeAgo = getTimeAgo(item.lastModifiedDateTime);\n\n            //console.log(iconAndName.icon);\n            //console.log(item);\n\n            //remove .url\n            var urlSplit = item.webUrl.split(\".\");\n            var urlLast = urlSplit.length - 1;\n            var newUrl = item.webUrl;\n            if (urlSplit[urlLast] == \"url\") {\n                urlSplit.pop();\n                newUrl = urlSplit.join(\".\");\n                console.log(newUrl);\n            }\n            //console.log(urlSplit);\n            //console.log(urlSplit.length);\n\n            //var listItem = $(\"<div />\");\n            var listItemLink = $(\"<a />\").attr('href', newUrl).attr('target', \"_blank\");\n            var container = $(\"<div />\").attr('class', 'itemContainer').appendTo(listItemLink);\n            var icon = $(\"<span />\").attr('class', 'iconContainer').html('<i class=\"ms-Icon ' + iconAndName.icon + '\" aria-hidden=\"true\"></i>').appendTo(container);\n            var listItem = $(\"<div />\").attr('class', 'contentContainer').attr('id', 'item' + num).appendTo(container);\n            var maxWidth = Math.max(customConfig.itemWidth, 64);\n            var name = $(\"<div />\", {'class': 'itemName', 'title': iconAndName.name, 'width': maxWidth }).html(iconAndName.name).appendTo(listItem);\n            var lmcbContainer = $(\"<div />\").attr('class', 'lmcbContainer').appendTo(listItem);\n            var lastModified = $(\"<div />\").attr('class', 'itemTime').html(timeAgo).appendTo(lmcbContainer);\n            var createdBy = $(\"<div />\").attr('class', 'itemBy').html('<span class=\"altText\">Created By </span>' + item.createdBy.user.displayName).appendTo(lmcbContainer);\n            $(\".recentFilesContent\").append(listItemLink);\n\n            getParentFolder(item.remoteItem.parentReference.driveId, i + 1);\n            //getIcon(item.id, i);\n        }\n    }\n\n    function getParentFolder(id, i) {\n        $.ajax({\n            url: \"https://graph.microsoft.com/v1.0/drives/\" + id + \"\",\n            headers: {\n                'Authorization': 'Bearer ' + token,\n                'Accept': 'application/json'\n            },\n            success: function (data, status) {\n                //console.log(data.driveType);\n\n                if (data.driveType == \"documentLibrary\") {\n                    //console.log(\"reached\");\n                    //var name = $(\"<div />\").html('<span class=\"altText\">Location </span>' + \"SharePoint\").appendTo(\"#item\"+ i +\"\");\n                    var name = $(\"<div />\").attr('class', 'locationIcon').html('<i class=\"ms-Icon ms-Icon--SharepointLogo\" aria-hidden=\"true\"></i>').appendTo(\"#item\" + i + \"\");\n                } else\n                if (data.driveType == \"business\") {\n                    //var name = $(\"<div />\").html('<span class=\"altText\">Location </span>' + \"OneDrive\").appendTo(\"#item\"+ i +\"\");\n                    var name = $(\"<div />\").attr('class', 'locationIcon').html('<i class=\"ms-Icon ms-Icon--OneDrive\" aria-hidden=\"true\"></i>').appendTo(\"#item\" + i + \"\");\n                }\n\n                //var name = $(\"<div />\").html(data.driveType).appendTo(\"#item\"+ i +\"\");\n            }\n        });\n    }\n\n    function getIconAndName(name) {\n        var parts = name.split(\".\");\n        var fileExtension = parts.pop();\n        var nameWithoutExtension = parts.join(\".\");\n\n        //console.log(nameWithoutExtension);\n        //console.log(fileExtension);\n\n        var iconClass = \"\";\n\n        switch (fileExtension) {\n            case 'docx':\n                iconClass = \"ms-Icon--WordLogo\";\n                break;\n            case 'doc':\n                iconClass = \"ms-Icon--WordLogo\";\n                break;\n            case 'pptx':\n                iconClass = \"ms-Icon--PowerPointLogo\";\n                break;\n            case 'ppt':\n                iconClass = \"ms-Icon--PowerPointLogo\";\n                break;\n            case 'xlsx':\n                iconClass = \"ms-Icon--ExcelLogo\";\n                break;\n            case 'xls':\n                iconClass = \"ms-Icon--ExcelLogo\";\n                break;\n            case 'csv':\n                iconClass = \"ms-Icon--ExcelLogo\";\n                break;\n            case 'one':\n                iconClass = \"ms-Icon--OneNoteLogo\";\n                break;\n            case 'pdf':\n                iconClass = \"ms-Icon--PDF\";\n                break;\n            case 'zip':\n                iconClass = \"ms-Icon--FolderFill\";\n                break;\n            case 'url':\n                iconClass = \"ms-Icon--Website\";\n                break;\n            case 'msg':\n                iconClass = \"ms-Icon--Mail\";\n                break;\n            case 'css':\n                iconClass = \"ms-Icon--CSS\";\n                break;\n            case 'js':\n                iconClass = \"ms-Icon--JS\";\n                break;\n            default:\n                iconClass = \"ms-Icon--PageSolid\";\n        }\n\n        return {\n            icon: iconClass,\n            name: nameWithoutExtension\n        };\n    }\n\n    function getTimeAgo(itemTime) {\n        var now = new Date();\n        var itemDate = new Date(itemTime);\n        var diffSeconds = parseInt((now - itemDate) / 1000);\n        var diffMinutes = parseInt(((now - itemDate) / 1000) / 60);\n        var diffHours = parseInt((((now - itemDate) / 1000) / 60) / 60);\n\n        var time = \"Ages Ago\";\n\n        //Less than 5 Minutes\n        if (diffMinutes < 5) {\n        time = \"Just Now\";\n        } else\n        //Less than 10 mintues\n        if (diffMinutes < 10) {\n        time = \"10 Minutes Ago\";\n        } else\n        //Less than 20 mintues\n        if (diffMinutes < 20) {\n        time = \"20 Minutes Ago\";\n        } else\n        //Less than 30 mintues\n        if (diffMinutes < 30) {\n        time = \"30 Minutes Ago\";\n        } else\n        //Less than 45 mintues\n        if (diffMinutes < 45) {\n            time = \"45 Minutes Ago\";\n        } else\n        //Less than 2 Hours\n        if (diffHours < 2) {\n            time = \"1 Hour Ago\";\n        } else\n        //Less than 3 hours\n        if (diffHours < 3) {\n            time = \"2 Hours Ago\";\n        } else\n        //Less than 4 Hours\n        if (diffHours < 4) {\n            time = \"3 Hours Ago\";\n        } else\n        //Less than 5 Hours\n        if (diffHours < 5) {\n            time = \"4 Hours Ago\";\n        } else\n        //Less than 6 Hours\n        if (diffHours < 6) {\n            time = \"5 Hours Ago\";\n        } else\n        //Less than 7 Hours\n        if (diffHours < 7) {\n            time = \"6 Hours Ago\";\n        } else\n        //Less than 8 Hours\n        if (diffHours < 8) {\n            time = \"7 Hours Ago\";\n        } else\n        //Less than 9 Hours\n        if (diffHours < 9) {\n            time = \"8 Hours Ago\";\n        } else\n        //Less than 10 Hours\n        if (diffHours < 10) {\n         time = \"9 Hours Ago\";\n        } else\n        //Less than 11 Hours\n        if (diffHours < 11) {\n         time = \"10 Hours Ago\";\n        } else\n        //Less than 12 Hours\n        if (diffHours < 12) {\n            time = \"11 Hours Ago\";\n        } else\n        //Less than 13 Hours\n        if (diffHours < 13) {\n            time = \"12 Hours Ago\";\n        } else\n        //Less than 48 Hours\n        if (diffHours < 48) {\n            time = \"Yesterday\";\n        } else\n            //Less than 3 days\n            if (diffHours < 72) {\n                var d = new Date();\n                d.setDate(now.getDate() - 2);\n                time = getDayString(d.getDay());\n        } else\n        //Less than 4 days\n        if (diffHours < 96) {\n            var d = new Date();\n            d.setDate(now.getDate() - 3);\n            time = getDayString(d.getDay());\n        } else\n        //Less than 5 days\n        if (diffHours < 120) {\n            var d = new Date();\n            d.setDate(now.getDate() - 4);\n            time = getDayString(d.getDay());\n        } else\n        //Less than 6 days\n        if (diffHours < 144) {\n            var d = new Date();\n            d.setDate(now.getDate() - 5);\n            time = getDayString(d.getDay());\n        } else\n        //Less than 7 days\n        if (diffHours < 168) {\n            var d = new Date();\n            d.setDate(now.getDate() - 6);\n            time = getDayString(d.getDay());\n        } else\n        //Less than 14 days\n        if (diffHours < 336) {\n        time = \"1 Week Ago\";\n        } else\n        //Less than 21 days\n        if (diffHours < 504) {\n        time = \"2 Weeks Ago\";\n        } else\n        //Less than 28 days\n        if (diffHours < 672) {\n        time = \"3 Weeks Ago\";\n        } else\n        //Less than 2 months\n        if (diffHours < 1460) {\n        time = \"1 Month Ago\";\n        } else\n        //Less than 3 months\n        if (diffHours < 2190) {\n        time = \"2 Months Ago\";\n        } else\n        //Less than 4 months\n        if (diffHours < 2920) {\n        time = \"3 Months Ago\";\n        } else\n        //Less than 5 months\n        if (diffHours < 3650) {\n        time = \"4 Months Ago\";\n        } else\n        //Less than 6 months\n        if (diffHours < 4380) {\n        time = \"5 Months Ago\";\n        } else\n        //Less than 7 months\n        if (diffHours < 5110) {\n        time = \"6 Months Ago\";\n        } else\n        //Less than 8 months\n        if (diffHours < 5840) {\n        time = \"7 Months Ago\";\n        } else\n        //Less than 9 months\n        if (diffHours < 6570) {\n        time = \"8 Months Ago\";\n        } else\n        //Less than 10 months\n        if (diffHours < 7300) {\n        time = \"9 Months Ago\";\n        } else\n        //Less than 11 months\n        if (diffHours < 8030) {\n        time = \"10 Months Ago\";\n        } else\n        //Less than 12 months\n        if (diffHours < 8760) {\n        time = \"11 Months Ago\";\n        } else\n        //Less than 2 years\n        if (diffHours < 17520) {\n        time = \"1 Year ago\";\n        } else\n        //Less than 3 years\n        if (diffHours < 26280) {\n            time = \"2 Years Ago\";\n        }\n\n        return time;\n    }\n\n    function getDayString(d) {\n        switch (new Date().getDay()) {\n            case 0:\n                day = \"Sunday\";\n                break;\n            case 1:\n                day = \"Monday\";\n                break;\n            case 2:\n                day = \"Tuesday\";\n                break;\n            case 3:\n                day = \"Wednesday\";\n                break;\n            case 4:\n                day = \"Thursday\";\n                break;\n            case 5:\n                day = \"Friday\";\n                break;\n            case 6:\n                day = \"Saturday\";\n        }\n\n        return day;\n    }\n}\n\n(function () {\n    setLogin();\n    //If we haven't received the token, check again in 1 second \n    if (interval == null)\n        interval = setInterval(setLogin, 1000);\n})();","isAutoHeight":false,"isSandbox":false,"canDesignersEditCode":true,"customConfig":{"props":[{"title":"Item Count Limit","name":"limit","type":1},{"title":"Title","name":"title","type":0},{"title":"Title Background","name":"titleBgColor","type":2},{"title":"Title Color","name":"titleColor","type":2},{"title":"Text Color","name":"color","type":2},{"title":"Item Name Width","name":"itemWidth","type":1}],"values":{"limit":"5","title":"My Recent Documents","titleBgColor":"rgb(0,190,156)","titleColor":"rgb(255,255,255)","color":"rgb(51,51,51)","itemWidth":"200"}},"groupTargeting":{"targetingMode":"NoTargeting","targetedGroups":[],"includeNested":true},"customClasses":"","id":"yvqcykgi","z":50}],"showForLarge":true,"showforMedium":true,"showForSmall":true,"showForExtraSmall":true}]}],"bgColor":"rgb(242,242,242)","padding":{"paddingBottom":"10","paddingLeft":"10","paddingRight":"10","paddingTop":"50"},"cellPadding":{"paddingBottom":"0","paddingLeft":"10","paddingRight":"10","paddingTop":"0"},"showForLarge":true,"showforMedium":true,"showForSmall":true,"showForExtraSmall":true,"customClasses":""}],"padding":{"paddingLeft":"10","paddingRight":"10","paddingTop":"0","paddingBottom":"0"},"widthStyle":0,"percentageWidth":100,"pixelWidth":1280,"isFixedSidePadding":true,"maxWidth":"","minWidth":""},"font":{"fontFamily":"'Roboto Condensed', sans-serif","fontSize":"13","fontColor":"black","isItalic":false,"fontWeight":"normal","isUnderlined":false,"fontFamilyOptions":{"isCustom":true,"selectedFont":"Custom","customFont":"'Roboto Condensed', sans-serif"}},"is3dStyle":false,"displaySideMenu":false,"designerStyle":"0","hasUpgradeRequestsMetaTag":true,"wireframeModeConfig":{"isEnabled":false,"isActive":false,"isInteractive":false},"assetData":{},"customHeadCode":"<style>\r\n\r\n.drop-shadow {\r\n\t-webkit-box-shadow: 0px 3px 5px 0px rgba(0,0,0,0.41);\r\n\t-moz-box-shadow: 0px 3px 5px 0px rgba(0,0,0,0.41);\r\n\tbox-shadow: 0px 3px 5px 0px rgba(0,0,0,0.41);\r\n}\r\n\r\n.rounded-corner {\r\n\tborder-radius: 3px;\r\n}\r\n\r\n.card {\r\n\twill-change: transform;\r\n  \tmargin: 8px;\r\n  \tposition: relative;\r\n  \tborder-radius: 2px;\r\n  \toverflow: hidden;\r\n  \tbackground-color: #fafafa;\r\n  \theight: 100%;\r\n  \twidth: 100%;\r\n  \t-webkit-transition: all 400ms cubic-bezier(0.165, 0.84, 0.44, 1);\r\n  \ttransition: all 400ms cubic-bezier(0.165, 0.84, 0.44, 1);\r\n  \tbox-shadow: 0 1px 4px 0 rgba(0, 0, 0, 0.37);\r\n}\r\n\r\n.lt-embed-tile {\r\n    border: none;\r\n}\r\n\r\n/*quick links*/\r\n.quickLinks {\r\n    width: 86px !important;\r\n    height: 390px !important;\r\n    position: fixed;\r\n    right: 25px;\r\n    bottom: 10%;\r\n    \r\n    border-radius: 6px;\r\n    z-index: 999;\r\n    \r\n}\r\n.quickLinks .lt-layout-item {\r\n    padding: 0;\r\n    margin: 0;\r\n    cursor: pointer;\r\n}\r\n\r\n.quickLinks .lt-layout-item:last-of-type {\r\n    border: none;\r\n}\r\n\r\n.quickLinks .lt-layout-item.closeBtn {\r\n    position: absolute;\r\n    top: -30px;\r\n    right: 5px;\r\n    width: 16px;\r\n    height: 16px;\r\n    border-bottom: none;\r\n}\r\n\r\n.quickLinks .lt-link-tile {\r\n    width: 56px;\r\n    height: 56px;\r\n    margin: 5px;\r\n    padding: 0;\r\n    position: relative;\r\n}\r\n.quickLinks .lt-layout-item.closeBtn .lt-link-tile {\r\n    width: 16px;\r\n    height: 16px;\r\n}\r\n\r\n/*end quick links*/\r\n\r\n\r\n</style>","customFootCode":"","customClasses":"","sideMenuConfig":{"bgColor":"rgb(54,54,54)","itemColor":"rgb(255, 255, 255)","hoverColor":"rgb(63, 63, 63)","font":{"fontFamily":"inherit","fontSize":"13","fontColor":"white","isItalic":false,"fontWeight":"normal","isUnderlined":false,"fontFamilyOptions":{"isCustom":false,"selectedFont":"Lato, 'Segoe UI', 'Helvetica Neue', sans-serif","customFont":""}},"width":"300","collapsedBgColor":"rgb(227,30,38)","shadowLineColor":"rgb(255, 255, 255)","backItemColor":"rgb(0, 161, 241)","headingColor":"rgb(255, 255, 255)","collapsedWidth":"60","linkTarget":"2","linkSource":"2"},"pageRoute":null,"pageVersion":"1527258880569","pageUniqueId":"cf7cb8c3b1d14841b6f39358a43996d6","domainUniqueId":"2d91cd8397414fc692d3a5f36ab3dce9"},"dependencies":[{"url":"https://ltcdntest.blob.core.windows.net/design/sharepoint/v4/content/Icons/Tile Gallery/Code.svg","toCopy":false},{"url":"~sitecollection/sitepages/IntranetHome3.aspx"}]}