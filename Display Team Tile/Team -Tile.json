{"config":{"id":"ec0df0767d4c43e3b6502ac9e203fd35","category":"Saved Tiles","description":"","defaultConfig":{"tileType":"AdvancedCodeSnippetTile","name":"Team -Tile","width":"280","height":"295","bgColor":"white","iconPath":"https://ltd.azureedge.net/sharepoint/v4/content/Icons/Tile Gallery/Code.svg","id":"bbpaybyh","locked":false,"html":"<!-- Office UI Fabric Icons -->\n<link rel=\"stylesheet\" href=\"https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/4.1.0/css/fabric.min.css\">\n\n<div id=\"{{uniqueId}}\">\n\t<div class=\"lt-title\">\n\t\tTeam\n\t</div>\n\n\t\n\t\n\t<div class=\"usersContainer nano has-scrollbar\" >\n\n</div>\n\t\n</div>","css":"#@{uniqueId} {\n    position: relative;\n    height: 100%;\n\n    ::-webkit-scrollbar {\n        width: 0px;  /* remove scrollbar space */\n        background: transparent;  /* optional: just make scrollbar invisible */\n    }\n\n    .lt-title {\n        padding: 15px 20px 10px 20px;\n        font-size: 21px;\n        font-weight: bold;\n    }\n\n    .usersContainer {\n        overflow-y: scroll;\n        height: ~\"calc(100% - 55px)\";\n    }\n\n    .userContainer {\n        position: relative;\n        overflow: auto;\n        clear: both;\n        margin: 0;\n        padding: 10px 0px;\n        border-bottom: 1px solid #eaeff3;\n    }\n\n    .errorContainer {\n        margin: 0px 15px;\n        padding: 10px 0px;\n        border-bottom: 1px solid #eaeff3;\n    }\n\n    .userImage {\n        float: left;\n        border-radius: 50%;\n        height: 40px;\n        width: 40px;\n    }\n\n    .userName {\n        float: left;\n        line-height: 40px;\n        padding-left: 10px;\n    }\n\n    .actionSkype {\n        float: right;\n        line-height: 40px;\n        font-size: 21px;\n    }\n\n    .actionSkype a {\n        color: #12A5F4;\n    }\n}","js":"var usersContainer = $('.usersContainer');\n\nvar url = _spPageContextInfo.webAbsoluteUrl + \"/_api/web/sitegroups/getbyname('\"+ customConfig.group +\"')/users\";\n$.ajax(\n    {\n        url: url,\n        method: \"GET\",\n        headers: {\n            \"accept\": \"application/json;odata=verbose\",\n        },\n        success: onSuccess,\n        error: onError\n    }\n);\n\nfunction onSuccess(data) {\n    var results = data.d.results;\n    results.forEach(function(item){\n        var userName = item.Title;\n        var userEmail = item.Email;\n        var userImage = _spPageContextInfo.webAbsoluteUrl + '/_layouts/15/userphoto.aspx?size=L&accountname=' + userEmail;\n\n        console.log(item);\n        var userContainer = $('<div />').attr('class', 'userContainer');\n        $('<img />').attr('class', 'userImage').attr('src', userImage).appendTo(userContainer);\n        $('<div />').attr('class','userName').html(userName).appendTo(userContainer);\n        $('<div />').attr('class','actionSkype').html('<a href=\"sip:'+ userEmail +'\"><i class=\"ms-Icon ms-Icon--SkypeLogo\" aria-hidden=\"true\"></i></a>').appendTo(userContainer);\n        usersContainer.append(userContainer);\n    });\n}\n\nfunction onError(data) {\n    var errorMessage = data.responseJSON.error.message.value\n\n    var errorContainer = $('<div />').attr('class', 'errorContainer');\n    $('<div />').attr('class','errorMessage').html(errorMessage).appendTo(errorContainer);\n    usersContainer.append(errorContainer);\n}","isAutoHeight":false,"isSandbox":false,"canDesignersEditCode":true,"customConfig":{"props":[{"title":"SharePoint Group","name":"group","type":0}],"values":{"group":"LiveTiles Owners"}},"groupTargeting":{"targetingMode":"NoTargeting","targetedGroups":[],"includeNested":true},"customClasses":"kpf card top team "},"assetData":{}},"dependencies":[{"url":"https://ltd.azureedge.net/sharepoint/v4/content/Icons/Tile Gallery/Code.svg","toCopy":false}]}